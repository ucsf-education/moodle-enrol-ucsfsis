define("enrol_ucsfsis/edit_form",["jquery","core/ajax","core/notification"],(function($,Ajax,Notification){return{cache:{courses:{},subjects:{}},courseId:null,termId:null,coursesDefaultOptionText:"",subjectsDefaultOptionText:"",$termSelect:null,$subjectSelect:null,$courseSelect:null,init:function(courseId,termId,subjects,courses,subjectDefaultOptionsText,coursesDefaultOptionText){this.$termSelect=$("#id_selectterm"),this.$subjectSelect=$("#id_selectsubject"),this.$courseSelect=$("#id_selectcourse"),this.courseId=courseId,this.termId=termId,this.subjectsDefaultOptionText=subjectDefaultOptionsText,this.coursesDefaultOptionText=coursesDefaultOptionText,this.cacheSubjectsAndCourses(this.termId,subjects,courses),this.$termSelect.change($.proxy(this,"changeTerm")),this.$subjectSelect.change($.proxy(this,"changeSubject")),this.enableForm()},changeSubject:function(event){var subjectId=$(event.target).find(":selected").val(),courses=this.cache.courses[this.termId][subjectId];this.repopulateSelect(this.$courseSelect,courses,this.coursesDefaultOptionText)},changeTerm:function(event){var termId=$(event.target).find(":selected").val(),that=this;this.disableForm(),this.termId=termId,this.cache.subjects.hasOwnProperty(this.termId)?setTimeout((function(){that.repopulateSelect(that.$subjectSelect,that.cache.subjects[that.termId],that.subjectsDefaultOptionText),that.repopulateSelect(that.$courseSelect,[],that.coursesDefaultOptionText),that.enableForm()}),500):Ajax.call([{methodname:"enrol_ucsfsis_get_subjects_and_courses_by_term",args:{courseid:this.courseId,termid:termId},done:this.processResponse.bind(this,termId),fail:Notification.exception}])},processResponse:function(termId,data){this.cacheSubjectsAndCourses(termId,data.subjects,data.courses),this.repopulateSelect(this.$subjectSelect,data.subjects,this.subjectsDefaultOptionText),this.repopulateSelect(this.$courseSelect,[],this.coursesDefaultOptionText),this.enableForm()},enableForm:function(){$("#id_status").prop("disabled",!1),this.$termSelect.prop("disabled",!1),this.$subjectSelect.prop("disabled",!1),this.$courseSelect.prop("disabled",!1),$("#id_roleid").prop("disabled",!1),$("#id_submitbutton").prop("disabled",!1)},disableForm:function(){$("#id_status").prop("disabled",!0),this.$termSelect.prop("disabled",!0),this.$subjectSelect.prop("disabled",!0),this.$courseSelect.prop("disabled",!0),$("#id_roleid").prop("disabled",!0),$("#id_submitbutton").prop("disabled",!0)},repopulateSelect:function($select,options,defaultOptionTitle){$select.children().remove().end(),$select.append($("<option>",{value:"",text:defaultOptionTitle})),$.each(options,(function(i,option){$select.append($("<option>",{value:option.id,text:option.title}))}))},cacheSubjectsAndCourses:function(termId,subjects,courses){var course,i,n;for(this.cache.subjects[termId]=subjects,this.cache.courses[termId]={},i=0,n=courses.length;i<n;i++)course=courses[i],this.cache.courses[termId].hasOwnProperty(course.subjectId)||(this.cache.courses[termId][course.subjectId]=[]),this.cache.courses[termId][course.subjectId].push(course)}}}));

//# sourceMappingURL=edit_form.min.js.map